{% extends "base.html" %}

{% block content %}
<h2>ðŸŒ¸ Cycle Tracker Dashboard</h2>

{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
    {% for category, message in messages %}
        <div class="flash {{ category }}">{{ message }}</div>
    {% endfor %}
{% endif %}
{% endwith %}

{% if error %}
    <div class="error">{{ error }}</div>
{% endif %}

<form method="POST">
    <h3>Option 1: I know my cycle length</h3>
    <label>Last Menstrual Date</label>
    <input type="date" name="last_period_known" value="{{ request.form.last_period_known }}">
    
    <label>Cycle Length (days)</label>
    <input type="number" name="cycle_length" value="{{ request.form.cycle_length }}" placeholder="e.g. 28">

    <hr>

    <h3>Option 2: I donâ€™t know my cycle length</h3>
    <label>Previous Menstrual Date</label>
    <input type="date" name="previous_period" value="{{ request.form.previous_period }}">
    
    <label>Last Menstrual Date</label>
    <input type="date" name="last_period_unknown" value="{{ request.form.last_period_unknown }}">

    <button type="submit">Calculate</button>
</form>

{% if results %}
<div class="results">
    <h3>ðŸ“Š Cycle Results</h3>
    <p><strong>Last Period:</strong> {{ results.last_period }}</p>
    <p><strong>Cycle Length:</strong> {{ results.cycle_length }} days</p>
    <p>ðŸŒ¸ <strong>Fertile Window:</strong> {{ results.fertile_start }} â†’ {{ results.fertile_end }}</p>
    <p>ðŸ”¥ <strong>Ovulation Peak:</strong> {{ results.ovulation_day }}</p>
    <p>ðŸ©¸ <strong>Expected Next Period:</strong> {{ results.next_period }}</p>
</div>
{% endif %}
{% endblock %}
